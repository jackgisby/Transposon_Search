getMatches <- function(SubSeqForward, Chr, chrName, max.mismatch = 0, with.indels = FALSE, fixed = TRUE){
  SubSeqReverse <- reverse(SubSeqForward)
  
  print(paste("Searching forward strand of", chrName))
  forwardMatches <- matchPattern(SubSeqForward, Chr, max.mismatch = max.mismatch, with.indels = with.indels, fixed = fixed) #gregexpr wrapper
  print(paste("Searching reverse strand", chrName))
  reverseMatches <- matchPattern(SubSeqReverse, Chr, max.mismatch = max.mismatch, with.indels = with.indels, fixed = fixed)
  
  if(length(forwardMatches@ranges@start) == 0) {
    forwardData <- NULL
    
  } else {
    forwardData <- data.frame("Chr" = paste(chrName, "F", sep=""), 
                             "Start" = forwardMatches@ranges@start,
                              "End" = forwardMatches@ranges@width)
  }
  
  if(length(reverseMatches@ranges@start) == 0) {
    reverseData <- NULL
    
  } else {
    reverseData <- data.frame("Chr" = paste(chrName, "R", sep=""), 
                              "Start" = reverseMatches@ranges@start,
                              "End" = reverseMatches@ranges@width)
  }
  
  print(paste(chrName, "search complete"))
  return(list(forwardData, reverseData))
}

