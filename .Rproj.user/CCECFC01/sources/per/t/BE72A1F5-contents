library(chromoMap)

Visualise <- function(Genome, forwardMatches, reverseMatches, chrList) {
  print("Starting chromoMap data preparation")
  write.table(forwardMatches, "Intermediate_Data/ForwardMatches.tsv", row.names = TRUE, sep = "\t", col.names = FALSE)
  write.table(reverseMatches, "Intermediate_Data/ReverseMatches.tsv", row.names = TRUE, sep = "\t", col.names = FALSE)
  
  ChrData <- data.frame(paste(chrList, "F", sep=""), "ChrStart" = 1, "ChrLength" = seqlengths(Genome))
  write.table(ChrData, "Intermediate_Data/ChrDataF.tsv", row.names = FALSE, sep = "\t", col.names = FALSE)
  ChrData <- data.frame(paste(chrList, "R", sep=""), "ChrStart" = 1, "ChrLength" = seqlengths(Genome))
  write.table(ChrData, "Intermediate_Data/ChrDataR.tsv", row.names = FALSE, sep = "\t", col.names = FALSE)
  
  print("Plotting chromoMap")
  return(chromoMap(c("Intermediate_Data/ChrDataF.tsv","Intermediate_Data/ChrDataR.tsv")
          ,c("Intermediate_Data/ForwardMatches.tsv","Intermediate_Data/ReverseMatches.tsv"), 
          ploidy = 2, 
          chr_width = 10,
          chr_length = 10,
          ch_gap = 8,
          canvas_width = 1100,
          canvas_height = 2000, 
          title = "Potential TIRs",
          segment_annotation = T))
  
  print("Plot complete")
}