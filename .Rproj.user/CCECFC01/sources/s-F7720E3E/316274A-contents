element.length = c(300, 5000)
for(forwardMatch in 1:length(forwardMatches)) {
  searchRange <- forwardMatches[forwardMatch]@ranges@start
  searchRange <- c(searchRange + element.length[1], searchRange + element.length[2])
  
  if(searchRange[2] > length(Genome$seqnames(forwardRepeat)@values)) {
    searchRange[2] <- length(Genome$seqnames(forwardRepeat)@values)
  }
  
  forwardRepeat <- forwardMatches[forwardMatch]
  reverseRepeats <- reverseMatches[seqnames(reverseMatches) == seqnames(forwardRepeat)@values
                                   & end(reverseMatches) > searchRange[1]
                                   & end(reverseMatches) < searchRange[2]
                                   & strand(reverseMatches) == "-"]
  
  for(reverseMatch in 1:length(reverseRepeats)) {
    fTSD <- flank(forwardRepeat, element.length)
    rTSD <- flank(reverseRepeats[reverseMatch], element.length)
    
    if(Genome$seqnames(forwardRepeat)@values[fTSD] == Genome$seqnames(forwardRepeat)@values[rTSD]) {
      
      potTransposons <- c(potTransposons, GRanges(seqnames = seqnames(forwardRepeat)@values[rTSD],
                                                  ranges = IRanges(start = searchRange[1] + 1, 
                                                                   end = searchRange[2] + 2)))
    }
  }
}
